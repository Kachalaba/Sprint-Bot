# Sprint Bot v1.0.0 — Release Notes

## Summary
Sprint Bot v1.0.0 promotes the project to a production-ready release with a hardened storage layer, multilingual UX, and CI/CD automation. The release finalises the migration path from Google Sheets to PostgreSQL, documents the architecture, and standardises release tooling (testing, linting, Docker images).

## Highlights
- ✅ Dual storage adapters with a production-grade PostgreSQL backend (`sprint_bot.infrastructure.storage`).
- ✅ Domain analytics reused across handlers, reports, and notifications (`sprint_bot.domain.analytics`).
- ✅ Internationalised bot responses backed by YAML locales under `i18n/`.
- ✅ Automated build pipelines: `lint.yml`, `tests.yml`, and `docker.yml` with semantic tagging.
- ✅ Reporting export module with caching and graph rendering (`reports/`).

## Breaking changes & migrations
1. **Switch default storage to Postgres**
   - Configure the runtime with `.env`:
     ```env
     STORAGE_BACKEND=postgres
     DB_URL=postgresql+asyncpg://user:password@host:5432/sprint_bot
     ```
   - Apply the schema:
     ```bash
     alembic upgrade head  # or `make migrate`
     ```
2. **Import historical data from Google Sheets** (one-off)
   - Populate Google credentials (`GOOGLE_APPLICATION_CREDENTIALS`) and `SPREADSHEET_KEY`.
   - Run the importer to backfill Postgres:
     ```bash
     python -m scripts.import_sheets  # or `make import_sheets`
     ```
   - The importer is idempotent; rerun safely after Sheets corrections.
3. **Update secrets rotation**
   - Ensure Docker/CI environments expose the new Postgres secrets before switching traffic.
   - Re-encrypt old Google Sheets credentials if they remain for import-only tasks.

## Internationalisation checklist
- Locales live under `i18n/` (`uk.yaml`, `ru.yaml`, etc.). Use the same keys as `i18n/uk.yaml` when adding new languages.
- Set the default locale via environment:
  ```env
  I18N_DOMAIN=sprint_bot
  DEFAULT_LOCALE=uk
  ```
- To add a language:
  1. Copy `i18n/uk.yaml` into a new file (`i18n/es.yaml`).
  2. Translate values, keeping plural rules intact.
  3. No code changes are required: the loader in `i18n/__init__.py` auto-detects `*.yaml` files, but remember to expose the locale via configuration/UI.
  4. Extend locale-specific tests in `tests/test_onboarding_flow.py` and related suites.

## Release process
1. **Version bump**
   - Update `VERSION` and `CHANGELOG.md` (this commit).
   - Commit with `release: prepare v1.0.0` and open a PR titled "Release v1.0.0".
2. **Continuous Integration**
   - Run locally before pushing:
     ```bash
     pip install -r requirements.txt
     pytest -q
     ```
   - CI must pass (`lint.yml`, `tests.yml`).
3. **Semantic tag & GitHub release**
   - Tag the merge commit: `git tag -a v1.0.0 -m "Sprint Bot v1.0.0"` and `git push origin v1.0.0`.
   - Publish the GitHub Release using these notes, attach:
     - `coverage.xml` from CI artifacts.
     - Docker image `kachalaba/sprint-bot:v1.0.0` (pushed automatically by `docker.yml`).
     - Optional CSV/XLSX samples from `reports/` if needed for stakeholders.
4. **Post-release validation**
   - Deploy with `docker compose` or Kubernetes manifests in `infra/`.
   - Hit `/ping` command in Telegram to validate storage connectivity.
   - Monitor logs (`logs/bot.log`) for localisation errors.

## Rollback strategy
- Roll back by re-tagging the previous release (e.g., `git tag -f v0.9.0 <commit>` and pushing).
- Restore Google Sheets mode by switching `.env` back to `STORAGE_BACKEND=sheets` and restarting the bot.
- Use database backups configured in `OPERATIONS.md` to restore Postgres if migration scripts introduced inconsistent data.
